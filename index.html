<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Story Writer App</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self';">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Title Bar -->
    <div class="title-bar">
        <input type="text" id="project-title" class="project-title" placeholder="Untitled Project">
        <div class="title-bar-controls">
            <button class="icon-button" id="new-project-btn" title="New Project">üìÑ</button>
            <button class="icon-button" id="save-btn" title="Save Project">üíæ</button>
            <button class="icon-button" id="save-as-btn" title="Save As">üíæüìÅ</button>
            <button class="icon-button" id="load-btn" title="Load Project">üìÅ</button>
            <button class="icon-button" id="system-prompt-btn" title="System Prompt">‚öôÔ∏è</button>
            <button class="icon-button" id="export-btn" title="Export Story">üì§</button>
        </div>
        <!-- Hidden file inputs -->
        <input type="file" id="load-file-input" accept=".json" class="hidden-file-input">
    </div>

    <div class="main-container">
        <!-- Left Panel - Entries -->
        <div id="entries-panel" class="entries-panel">
            <div class="entries-header">
                <span>Entries:</span>
                <button id="collapse-sidebar-btn" class="collapse-btn" title="Toggle Sidebar">‚Üê</button>
            </div>
            <div id="entries-list"></div>
            <div class="controls">
                <button class="add-button" id="add-entry-btn">Add Entry</button>
            </div>
        </div>

        <!-- Right Panel - Story -->
        <div class="story-panel">
            <div class="story-header">Story:</div>
            <div class="chapters-container" id="chapters-container"></div>
            <div class="controls">
                <button class="add-button" id="add-chapter-btn">Add Chapter</button>
            </div>
        </div>
    </div>

    <!-- Entry Dialog -->
    <div id="dialog-overlay" class="dialog-overlay">
        <div class="entry-dialog">
            <div class="dialog-header">
                Entry Details
            </div>
            <div class="dialog-content">
                <div class="dialog-field">
                    <label for="dialog-title">Title:</label>
                    <input type="text" id="dialog-title">
                </div>
                
                <div class="dialog-field">
                    <label for="dialog-type-input">Type:</label>
                    <div class="combobox-container">
                        <input type="text" id="dialog-type-input" placeholder="Type or select an entry type..." autocomplete="off">
                        <button type="button" class="combobox-dropdown-btn" id="type-dropdown-btn">‚ñº</button>
                        <div class="combobox-dropdown" id="type-dropdown">
                            <!-- Options will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                                
                <div class="dialog-field checkbox-field">
                    <input type="checkbox" id="dialog-global">
                    <label for="dialog-global">Global Entry</label>
                </div>
                
                <div class="dialog-field">
                    <label for="dialog-description">Description:</label>
                    <textarea id="dialog-description" placeholder="Enter entry description..."></textarea>
                </div>
                
                <div class="details-section">
                    <div class="details-header">Details:</div>
                    <div id="details-container"></div>
                    <button type="button" class="add-button" id="add-detail-btn">Add Detail</button>
                </div>
            </div>
            <div class="dialog-buttons">
                <button class="dialog-button danger" id="dialog-delete">Delete</button>
                <div>
                    <button class="dialog-button secondary" id="dialog-cancel">Cancel</button>
                    <button class="dialog-button primary" id="dialog-save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirmation-overlay" class="dialog-overlay">
        <div class="confirmation-dialog">
            <div class="dialog-header">
                Confirm Delete
            </div>
            <div class="dialog-content">
                <p id="confirmation-message">Are you sure you want to delete this entry?</p>
            </div>
            <div class="dialog-buttons">
                <button class="dialog-button secondary" id="confirmation-cancel">No</button>
                <button class="dialog-button danger" id="confirmation-confirm">Yes</button>
            </div>
        </div>
    </div>

    <!-- System Prompt Dialog -->
    <div id="system-prompt-overlay" class="dialog-overlay">
        <div class="system-prompt-dialog">
            <div class="dialog-header">
                System Prompt Configuration
            </div>
            <div class="dialog-content">
                <div class="dialog-field">
                    <label for="system-prompt-text">System Prompt</label>
                    <textarea id="system-prompt-text" rows="6" placeholder="Enter your system prompt instructions for the AI..."></textarea>
                </div>
                <div class="dialog-field">
                    <label for="style-guide-text">Style Guide</label>
                    <textarea id="style-guide-text" rows="6" placeholder="Enter your writing style guidelines..."></textarea>
                </div>
                <div class="dialog-field">
                    <label for="story-genre-input">Story Genre</label>
                    <div class="combobox-container">
                        <input type="text" id="story-genre-input" placeholder="Type or select a genre..." autocomplete="off">
                        <button type="button" class="combobox-dropdown-btn" id="genre-dropdown-btn">‚ñº</button>
                        <div class="combobox-dropdown" id="genre-dropdown">
                            <!-- Options will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="dialog-field">
                    <label for="tense-select">Tense</label>
                    <select id="tense-select">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="dialog-field">
                    <label for="language-select">Language</label>
                    <select id="language-select">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="dialog-field">
                    <label for="point-of-view-select">Point of View</label>
                    <select id="point-of-view-select">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="dialog-field">
                    <label for="character-select">Character</label>
                    <select id="character-select">
                        <option value="">Select a character...</option>
                        <!-- Character options will be populated by JavaScript -->
                    </select>
                </div>                
            </div>
            <div class="dialog-buttons">
                <button class="dialog-button secondary" id="system-prompt-cancel">Cancel</button>
                <button class="dialog-button primary" id="system-prompt-save">Save</button>
            </div>
        </div>
    </div>
    
    <!-- Detail Dialog -->
    <div id="detail-dialog-overlay" class="dialog-overlay">
        <div class="detail-dialog">
            <div class="dialog-header">Add Detail</div>
            <div class="dialog-content">
                <div class="dialog-field">
                    <label for="detail-title-input">Title</label>
                    <div class="combobox-container">
                        <input type="text" id="detail-title-input" placeholder="Enter or select title..." autocomplete="off">
                        <button type="button" class="combobox-dropdown-btn" id="detail-title-dropdown-btn">‚ñº</button>
                        <div class="combobox-dropdown" id="detail-title-dropdown">
                            <!-- Options will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <div class="dialog-field">
                    <label>Value Type</label>
                    <div class="radio-group">
                        <input type="radio" id="value-type-text" name="value-type" value="text" checked>
                        <label for="value-type-text">Text</label>
                        
                        <input type="radio" id="value-type-combobox" name="value-type" value="combobox">
                        <label for="value-type-combobox">Combobox</label>
                    </div>
                </div>
                
                <div class="dialog-field" id="text-field-container">
                    <label for="detail-text-input">Text</label>
                    <input type="text" id="detail-text-input" placeholder="Enter text value...">
                </div>
                
                <div class="dialog-field" id="combobox-field-container">
                    <label for="detail-option-input">Option</label>
                    <div class="combobox-container">
                        <input type="text" id="detail-option-input" placeholder="Enter or select option..." autocomplete="off">
                        <button type="button" class="combobox-dropdown-btn" id="detail-option-dropdown-btn">‚ñº</button>
                        <div class="combobox-dropdown" id="detail-option-dropdown">
                            <!-- Options will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dialog-buttons">
                <button class="dialog-button secondary" id="detail-dialog-cancel">Cancel</button>
                <button class="dialog-button primary" id="detail-dialog-save">Add Detail</button>
            </div>
        </div>
    </div>


    <!-- Prompt Dialog -->
    <div id="prompt-dialog-overlay" class="dialog-overlay">
        <div class="prompt-dialog">
            <div class="dialog-header">Generated Prompt</div>
            <div class="dialog-content">
                <div class="dialog-field">
                    <label for="prompt-text-display">AI Prompt</label>
                    <textarea id="prompt-text-display" rows="15" readonly></textarea>
                </div>
            </div>
            <div class="dialog-buttons">
                <button class="dialog-button secondary" id="prompt-dialog-close">Close</button>
                <button class="dialog-button primary" id="prompt-copy-btn">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Export Story Dialog -->
    <div id="export-dialog-overlay" class="dialog-overlay">
        <div class="export-dialog">
            <div class="dialog-header">
                Export Story
            </div>
            <div class="dialog-content">
                <div class="dialog-field">
                    <label for="export-text">Story Text:</label>
                    <textarea id="export-text" readonly></textarea>
                </div>
            </div>
            <div class="dialog-buttons">
                <button class="dialog-button secondary" id="export-dialog-close">Close</button>
                <button class="dialog-button primary" id="export-copy-btn">Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Include scripts in order -->
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>
